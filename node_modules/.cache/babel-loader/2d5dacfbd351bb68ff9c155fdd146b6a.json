{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\jison\\\\OneDrive\\\\Desktop\\\\digital-e-gram-panchayat\\\\src\\\\components\\\\AppApply.js\";\nimport React, { useEffect, useState } from 'react';\nimport { useLocation, useNavigate } from 'react-router-dom';\nimport { doc, getDoc, collection, addDoc, serverTimestamp, query, where, getDocs } from 'firebase/firestore';\nimport { db } from '../firebase';\nimport { auth } from '../firebase';\nfunction AppApply() {\n  const location = useLocation();\n  const navigate = useNavigate();\n  const {\n    applicationId\n  } = location.state || {};\n  const [application, setApplication] = useState(null);\n  const [userDoc, setUserDoc] = useState(null);\n  const [message, setMessage] = useState('');\n  useEffect(() => {\n    var _auth$currentUser;\n    const uid = (_auth$currentUser = auth.currentUser) === null || _auth$currentUser === void 0 ? void 0 : _auth$currentUser.uid;\n    if (!applicationId || !uid) {\n      alert('Invalid Access');\n      navigate('/login');\n      return;\n    }\n    const fetchData = async () => {\n      try {\n        // Get application info\n        const appDoc = await getDoc(doc(db, 'applications', applicationId));\n        if (!appDoc.exists()) throw new Error('Application not found');\n        setApplication(appDoc.data());\n\n        // Get user doc from `users` collection where email matches current user\n        const q = query(collection(db, 'users'), where('email', '==', auth.currentUser.email));\n        const snap = await getDocs(q);\n        if (snap.empty) throw new Error('User data not found');\n        const docSnap = snap.docs[0];\n        setUserDoc({\n          id: docSnap.id,\n          ...docSnap.data()\n        });\n      } catch (err) {\n        console.error(err);\n        alert(err.message);\n        navigate('/dashboard');\n      }\n    };\n    fetchData();\n  }, [applicationId, navigate]);\n  const handleSubmit = async () => {\n    if (!message.trim()) {\n      alert('Please write a message.');\n      return;\n    }\n    try {\n      await addDoc(collection(db, 'Applied'), {\n        applicationId: applicationId,\n        userId: userDoc.id,\n        // Using the document ID as userId\n        message: message.trim(),\n        timestamp: serverTimestamp()\n      });\n      alert('Application submitted!');\n      navigate('/dashboard');\n    } catch (err) {\n      console.error(err);\n      alert('Submission failed.');\n    }\n  };\n  if (!application || !userDoc) return /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 71,\n      columnNumber: 40\n    }\n  }, \"Loading...\");\n  return /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      padding: '20px',\n      maxWidth: '700px',\n      margin: 'auto'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 74,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"h2\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 75,\n      columnNumber: 7\n    }\n  }, \"Apply for: \", application.name), /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 76,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"strong\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 76,\n      columnNumber: 10\n    }\n  }, \"Category:\"), \" \", application.category), /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 77,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"strong\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 77,\n      columnNumber: 10\n    }\n  }, \"Status:\"), \" \", application.status), /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 78,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"strong\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 78,\n      columnNumber: 10\n    }\n  }, \"Description:\"), \" \", application.message), /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      marginTop: '30px'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 80,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"h3\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 81,\n      columnNumber: 9\n    }\n  }, \"Your Details\"), /*#__PURE__*/React.createElement(\"input\", {\n    type: \"text\",\n    value: userDoc.name,\n    readOnly: true,\n    style: {\n      width: '100%',\n      marginBottom: '10px',\n      padding: '10px',\n      backgroundColor: '#eee'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 82,\n      columnNumber: 9\n    }\n  }), /*#__PURE__*/React.createElement(\"input\", {\n    type: \"text\",\n    value: userDoc.email,\n    readOnly: true,\n    style: {\n      width: '100%',\n      marginBottom: '10px',\n      padding: '10px',\n      backgroundColor: '#eee'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 83,\n      columnNumber: 9\n    }\n  }), /*#__PURE__*/React.createElement(\"textarea\", {\n    placeholder: \"Write your message here...\",\n    value: message,\n    onChange: e => setMessage(e.target.value),\n    rows: 4,\n    style: {\n      width: '100%',\n      marginBottom: '10px',\n      padding: '10px'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 84,\n      columnNumber: 9\n    }\n  }), /*#__PURE__*/React.createElement(\"button\", {\n    onClick: handleSubmit,\n    style: {\n      padding: '10px 20px'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 91,\n      columnNumber: 9\n    }\n  }, \"Submit Application\")), /*#__PURE__*/React.createElement(\"button\", {\n    onClick: () => navigate('/dashboard'),\n    style: {\n      marginTop: '20px'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 96,\n      columnNumber: 7\n    }\n  }, \"Back to Dashboard\"));\n}\nexport default AppApply;","map":{"version":3,"names":["React","useEffect","useState","useLocation","useNavigate","doc","getDoc","collection","addDoc","serverTimestamp","query","where","getDocs","db","auth","AppApply","location","navigate","applicationId","state","application","setApplication","userDoc","setUserDoc","message","setMessage","_auth$currentUser","uid","currentUser","alert","fetchData","appDoc","exists","Error","data","q","email","snap","empty","docSnap","docs","id","err","console","error","handleSubmit","trim","userId","timestamp","createElement","__self","__source","fileName","_jsxFileName","lineNumber","columnNumber","style","padding","maxWidth","margin","name","category","status","marginTop","type","value","readOnly","width","marginBottom","backgroundColor","placeholder","onChange","e","target","rows","onClick"],"sources":["C:/Users/jison/OneDrive/Desktop/digital-e-gram-panchayat/src/components/AppApply.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport { useLocation, useNavigate } from 'react-router-dom';\r\nimport { doc, getDoc, collection, addDoc, serverTimestamp, query, where, getDocs } from 'firebase/firestore';\r\nimport { db } from '../firebase';\r\nimport { auth } from '../firebase';\r\n\r\nfunction AppApply() {\r\n  const location = useLocation();\r\n  const navigate = useNavigate();\r\n  const { applicationId } = location.state || {};\r\n\r\n  const [application, setApplication] = useState(null);\r\n  const [userDoc, setUserDoc] = useState(null);\r\n  const [message, setMessage] = useState('');\r\n\r\n  useEffect(() => {\r\n    const uid = auth.currentUser?.uid;\r\n\r\n    if (!applicationId || !uid) {\r\n      alert('Invalid Access');\r\n      navigate('/login');\r\n      return;\r\n    }\r\n\r\n    const fetchData = async () => {\r\n      try {\r\n        // Get application info\r\n        const appDoc = await getDoc(doc(db, 'applications', applicationId));\r\n        if (!appDoc.exists()) throw new Error('Application not found');\r\n        setApplication(appDoc.data());\r\n\r\n        // Get user doc from `users` collection where email matches current user\r\n        const q = query(collection(db, 'users'), where('email', '==', auth.currentUser.email));\r\n        const snap = await getDocs(q);\r\n        if (snap.empty) throw new Error('User data not found');\r\n\r\n        const docSnap = snap.docs[0];\r\n        setUserDoc({ id: docSnap.id, ...docSnap.data() });\r\n      } catch (err) {\r\n        console.error(err);\r\n        alert(err.message);\r\n        navigate('/dashboard');\r\n      }\r\n    };\r\n\r\n    fetchData();\r\n  }, [applicationId, navigate]);\r\n\r\n  const handleSubmit = async () => {\r\n    if (!message.trim()) {\r\n      alert('Please write a message.');\r\n      return;\r\n    }\r\n\r\n    try {\r\n      await addDoc(collection(db, 'Applied'), {\r\n        applicationId: applicationId,\r\n        userId: userDoc.id,         // Using the document ID as userId\r\n        message: message.trim(),\r\n        timestamp: serverTimestamp()\r\n      });\r\n\r\n      alert('Application submitted!');\r\n      navigate('/dashboard');\r\n    } catch (err) {\r\n      console.error(err);\r\n      alert('Submission failed.');\r\n    }\r\n  };\r\n\r\n  if (!application || !userDoc) return <p>Loading...</p>;\r\n\r\n  return (\r\n    <div style={{ padding: '20px', maxWidth: '700px', margin: 'auto' }}>\r\n      <h2>Apply for: {application.name}</h2>\r\n      <p><strong>Category:</strong> {application.category}</p>\r\n      <p><strong>Status:</strong> {application.status}</p>\r\n      <p><strong>Description:</strong> {application.message}</p>\r\n\r\n      <div style={{ marginTop: '30px' }}>\r\n        <h3>Your Details</h3>\r\n        <input type=\"text\" value={userDoc.name} readOnly style={{ width: '100%', marginBottom: '10px', padding: '10px', backgroundColor: '#eee' }} />\r\n        <input type=\"text\" value={userDoc.email} readOnly style={{ width: '100%', marginBottom: '10px', padding: '10px', backgroundColor: '#eee' }} />\r\n        <textarea\r\n          placeholder=\"Write your message here...\"\r\n          value={message}\r\n          onChange={(e) => setMessage(e.target.value)}\r\n          rows={4}\r\n          style={{ width: '100%', marginBottom: '10px', padding: '10px' }}\r\n        />\r\n        <button onClick={handleSubmit} style={{ padding: '10px 20px' }}>\r\n          Submit Application\r\n        </button>\r\n      </div>\r\n\r\n      <button onClick={() => navigate('/dashboard')} style={{ marginTop: '20px' }}>\r\n        Back to Dashboard\r\n      </button>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default AppApply;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}